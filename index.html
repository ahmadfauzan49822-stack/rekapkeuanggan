<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rekap Keuangan Maabas Mart</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            background-color: #f5fef6;
            color: #333;
        }
        header {
            background-color: #2e7d32;
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
        }
        .container {
            padding: 20px;
            max-width: 1100px;
            margin: auto;
        }
        .dashboard {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        .card {
            flex: 1;
            min-width: 250px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
        }
        .card h3 {
            margin: 0;
            font-size: 1.2em;
            color: #2e7d32;
        }
        .card p {
            font-size: 1.5em;
            font-weight: bold;
        }
        form {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        form input, form select, form button {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        form button {
            background-color: #2e7d32;
            color: white;
            border: none;
            cursor: pointer;
        }
        form button:hover {
            background-color: #1b5e20;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        th, td {
            padding: 10px;
            border-bottom: 1px solid #ddd;
            text-align: left;
        }
        th {
            background-color: #2e7d32;
            color: white;
        }
        .summary {
            background: white;
            padding: 15px;
            margin-top: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        @media (max-width: 600px) {
            .dashboard {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header>Rekap Keuangan Maabas Mart</header>
    <div class="container">
        <div class="dashboard">
            <div class="card">
                <h3>Total Pemasukan</h3>
                <p id="totalPemasukan">Rp 0</p>
            </div>
            <div class="card">
                <h3>Total Pengeluaran</h3>
                <p id="totalPengeluaran">Rp 0</p>
            </div>
            <div class="card">
                <h3>Saldo Akhir</h3>
                <p id="saldoAkhir">Rp 0</p>
            </div>
        </div>

        <form id="formTransaksi">
            <h3>Tambah Transaksi</h3>
            <input type="date" id="tanggal" required>
            <input type="text" id="keterangan" placeholder="Keterangan" required>
            <select id="kategori" required>
                <option value="">Pilih Kategori</option>
                <option value="pemasukan">Pemasukan</option>
                <option value="pengeluaran">Pengeluaran</option>
            </select>
            <input type="number" id="nominal" placeholder="Nominal" required>
            <button type="submit">Tambah</button>
        </form>

        <div style="margin-bottom: 10px;">
            <input type="date" id="filterTanggal">
            <select id="filterKategori">
                <option value="">Semua Kategori</option>
                <option value="pemasukan">Pemasukan</option>
                <option value="pengeluaran">Pengeluaran</option>
            </select>
            <button onclick="tampilkanData()">Filter</button>
            <button onclick="resetFilter()">Reset</button>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Tanggal</th>
                    <th>Keterangan</th>
                    <th>Kategori</th>
                    <th>Nominal</th>
                </tr>
            </thead>
            <tbody id="tabelTransaksi"></tbody>
        </table>

        <div class="summary">
            <h3>Ringkasan Detail</h3>
            <p id="jumlahTransaksi">Jumlah Transaksi: 0</p>
            <p id="rataPemasukan">Rata-rata Pemasukan: Rp 0</p>
            <p id="rataPengeluaran">Rata-rata Pengeluaran: Rp 0</p>
            <p id="transaksiTerbesar">Transaksi Terbesar: -</p>
        </div>
    </div>

    <script>
        let transaksi = JSON.parse(localStorage.getItem('transaksi')) || [];

        document.getElementById('formTransaksi').addEventListener('submit', function(e) {
            e.preventDefault();
            const tanggal = document.getElementById('tanggal').value;
            const keterangan = document.getElementById('keterangan').value.trim();
            const kategori = document.getElementById('kategori').value;
            const nominal = parseFloat(document.getElementById('nominal').value);
            if (!tanggal || !keterangan || !kategori || isNaN(nominal)) return;

            transaksi.push({ tanggal, keterangan, kategori, nominal });
            localStorage.setItem('transaksi', JSON.stringify(transaksi));

            this.reset();
            tampilkanData();
        });

        function tampilkanData() {
            const filterTanggal = document.getElementById('filterTanggal').value;
            const filterKategori = document.getElementById('filterKategori').value;
            const tbody = document.getElementById('tabelTransaksi');
            tbody.innerHTML = '';

            let totalPemasukan = 0;
            let totalPengeluaran = 0;
            let countPemasukan = 0;
            let countPengeluaran = 0;
            let transaksiTerbesar = null;

            let filtered = transaksi.filter(t => {
                return (!filterTanggal || t.tanggal === filterTanggal) &&
                       (!filterKategori || t.kategori === filterKategori);
            });

            filtered.forEach(t => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${t.tanggal}</td><td>${t.keterangan}</td><td>${t.kategori}</td><td>Rp ${t.nominal.toLocaleString('id-ID')}</td>`;
                tbody.appendChild(tr);

                if (t.kategori === 'pemasukan') {
                    totalPemasukan += t.nominal;
                    countPemasukan++;
                } else {
                    totalPengeluaran += t.nominal;
                    countPengeluaran++;
                }

                if (!transaksiTerbesar || t.nominal > transaksiTerbesar.nominal) {
                    transaksiTerbesar = t;
                }
            });

            document.getElementById('totalPemasukan').innerText = 'Rp ' + totalPemasukan.toLocaleString('id-ID');
            document.getElementById('totalPengeluaran').innerText = 'Rp ' + totalPengeluaran.toLocaleString('id-ID');
            document.getElementById('saldoAkhir').innerText = 'Rp ' + (totalPemasukan - totalPengeluaran).toLocaleString('id-ID');

            document.getElementById('jumlahTransaksi').innerText = 'Jumlah Transaksi: ' + filtered.length;
            document.getElementById('rataPemasukan').innerText = 'Rata-rata Pemasukan: Rp ' + (countPemasukan ? (totalPemasukan / countPemasukan).toLocaleString('id-ID') : 0);
            document.getElementById('rataPengeluaran').innerText = 'Rata-rata Pengeluaran: Rp ' + (countPengeluaran ? (totalPengeluaran / countPengeluaran).toLocaleString('id-ID') : 0);
            document.getElementById('transaksiTerbesar').innerText = transaksiTerbesar ? `Transaksi Terbesar: Rp ${transaksiTerbesar.nominal.toLocaleString('id-ID')} (${transaksiTerbesar.keterangan})` : 'Transaksi Terbesar: -';
        }

        function resetFilter() {
            document.getElementById('filterTanggal').value = '';
            document.getElementById('filterKategori').value = '';
            tampilkanData();
        }

        tampilkanData();
    </script>
</body>
</html>
